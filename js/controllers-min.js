app.controller("chapterController",function(e,t,a){function r(){console.log(e.chapters[e.chapterID].correctPercent)}function s(){var t=0;for(var a in e.chapters[e.chapterID].answered){var s=e.chapters[e.chapterID].answered[a];e.questions[e.chapterID].questions[a].answers[s].correct&&t++}e.chapters[e.chapterID].correctCount=t,e.chapters[e.chapterID].correctPercent=Math.floor(e.chapters[e.chapterID].correctCount/e.questions[e.chapterID].questions.length*100),r(),window.localStorage[o]=JSON.stringify(e.chapters)}function n(t){function a(){$("#search").val("").trigger("keyup"),$("figure").each(function(){var e=$(this).attr("data-id");if($(this).hasClass("video")){$(this).prepend("<span>Figure "+e+"</span> &mdash; "),$(this).wrapInner("<figcaption></figcaption>");var t="media/"+e+".mp4",a=$('<video controls src="'+t+'">');$(this).prepend(a)}else{$(this).attr("data-frames")&&(e+=$(this).attr("data-frames").split(",")[0]),$(this).prepend("<span>Figure "+e+"</span> &mdash; "),$(this).wrapInner("<figcaption></figcaption>");var r="media/"+e+".jpg",s=$('<img src="'+r+'">');$(this).prepend(s)}}),$(".alert-note").each(function(){$(this).prepend("<h5>NOTE</h5>")}),$(".alert-warning").each(function(){$(this).prepend('<h5><i class="icon mdi mdi-warning"></i>WARNING<i class="icon mdi mdi-warning"></i></h5>')}),$(".alert-caution").each(function(){$(this).prepend('<h5><i class="icon mdi mdi-warning"></i>CAUTION<i class="icon mdi mdi-warning"></i></h5>')})}e.chapters=t,s(),e.bookmarkToggle=function(){1==e.chapters[e.chapterID].bookmarked?e.chapters[e.chapterID].bookmarked=!1:e.chapters[e.chapterID].bookmarked=!0,$(".bookmark-toggle-btn").toggleClass("bookmarked"),s()},e.openChapter=function(t){e.chapterID=t,23===e.chapterID?e.translatedChapterID="A1":e.translatedChapterID="A2",e.chapterQuestions=e.questions[t].questions,$(".portal").empty().load(t+".html",function(){for(var t in e.chapters[e.chapterID].answered)$(".quiz").eq(parseInt(t)).find(".quiz-answer").eq(e.chapters[e.chapterID].answered[t]).addClass("selected");a(),r()})},e.selectAnswer=function(t){var a=$(t.target);a.addClass("selected").siblings().removeClass("selected");var r=a.parent().children().index(a),n=a.closest(".quiz").index(".quiz");return e.chapters[e.chapterID].answered||(e.chapters[e.chapterID].answered={}),e.chapters[e.chapterID].answered[n]=r,s(),!1},e.testSelectAnswer=function(t,a,r){return $(t.target).addClass("selected").siblings().removeClass("selected"),e.currentTestData.questions[a].selected=r,!1},e.openChapter(e.chapterID)}e.version="1.1",e.numbersToLetters={0:"A",1:"B",2:"C",3:"D"},e.startChapter=1,e.chapterID=e.startChapter;var o="NETCtoolsAlphaChaptersC";a.get("chapterQuestions.json").then(function(t){e.questions=t.data,window.localStorage[o]?n(JSON.parse(window.localStorage[o])):a.get("chapters.json").then(function(e){n(e.data)})}),e.initTest=function(){e.testing=!0,a.get("testSHORT.json").then(function(t){e.allTestData=t.data,e.testMapping=[];for(key in e.allTestData)e.testMapping.push(key);console.log(e.testMapping),e.currentTestIndex=0,e.currentTestData=e.allTestData[e.testMapping[e.currentTestIndex]]})},e.modalAlert=function(e,t){$("#alertModal .modal-title").text(e),$("#alertModal .modal-body").text(t),$("#alertModal").modal()},e.loadTest=function(t){$(".test-area .quiz").length===$(".test-area .quiz a.selected").length||t<e.currentTestIndex?(e.currentTestIndex=t,e.currentTestData=e.allTestData[e.testMapping[e.currentTestIndex]]):e.modalAlert("Missing Answers","Answer all questions before proceeding.")},e.answerClass=function(t,a){var r="";return e.currentTestData.questions[t].answers[a].correct?r+="test-correct ":r+="test-incorrect ",e.currentTestData.questions[t].selected&&e.currentTestData.questions[t].selected===a&&(r+="selected "),r},e.gradeTest=function(){var t=[];for(key in e.allTestData)$.each(e.allTestData[key].questions,function(){t.push(this)});var a=0,r=t.length;console.log(t);for(var s=0;s<t.length;s++)t[s].selected&&t[s].answers[t[s].selected].correct&&a++;console.log(a,r,a/r)},e.resetData=function(){confirm("This will reset all bookmarks and saved progress, do you want to continue?")&&a.get("chapters.json").then(function(e){$(".quiz-answer").removeClass("selected"),n(e.data)})}});